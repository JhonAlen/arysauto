<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">

<app-toolbar></app-toolbar>
  <div data-aos="fade-in-down" data-aos-delay="200" *ngIf="alert.show" class="alert-container">
    <ngb-alert *ngIf="alert.show" [type]="alert.type">{{ alert.message | translate }}</ngb-alert>
  </div>
<section>
  <div>
    <div style="display: grid;place-items: center;">
      <p style="font-size: xx-large;">INCLUSIÓN A LA FLOTA</p>
    </div>
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-12">
        <!-- formulario de busqueda y -->
        <form [formGroup]="inclusion_form"> 
          <div class="row g-0">
            <!-- Datos personales -->
            <div class="card">
             <div class="card-header company-card-header"><h5 class="card-title">Datos Personales</h5></div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-2 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required" for="form3Examplev2">Tipo Doc. Ide</label>
                      <select formControlName="icedula" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('icedula').errors } " >
                        <option value="V">V</option>
                        <option value="P">P</option>
                        <option value="E">E</option>
                        <option value="J">J</option>
                        <option value="C">C</option>
                        <option value="G">G</option>
                      </select>                      
                      <div *ngIf="submitted && inclusion_form.get('icedula').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('icedula').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required" for="form3Examplev2">Identificación</label>
                      <input type="text" formControlName="xrif_cliente" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xrif_cliente').errors }" (change)="Validation()"/>
                      <div *ngIf="submitted && inclusion_form.get('xrif_cliente').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xrif_cliente').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required">Nombre y Apellido del Cliente</label>
                      <input type="text" formControlName="xnombre" class="form-control form-control-lg" required [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xnombre').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xnombre').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xnombre').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required">Número de Teléfono</label>
                      <input type="text" formControlName="xtelefono_emp" class="form-control form-control-lg"  maxlength = "12" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xtelefono_emp').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xtelefono_emp').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xtelefono_emp').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label " for="form3Examplev3">Teléfono Alterno</label>
                      <input type="text" formControlName="xtelefono_prop" class="form-control form-control-lg" maxlength = "12" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xtelefono_prop').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xtelefono_prop').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xtelefono_prop').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required" for="form3Examplev3">Correo Electrónico</label>
                      <input type="email" formControlName="email" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('email').errors }" (change)="activePassword()">
                      <div *ngIf="submitted && inclusion_form.get('email').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('email').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2" style="background-color: #ffbc0059;border-radius: 15px;" *ngIf="activaClave">
                    <div class="form-outline">
                      <p for="form3Examplev3" class="form-label">Contraseña predeterminada</p>
                      <h5>Ar654321!</h5>
                    </div>
                  </div>
                  <div class="col-md-8 mb-4 pb-2">
                    <div class="form-outline ">
                      <label class="form-label required" for="form3Examplea2">Dirección Fiscal</label>
                      <input type="text" formControlName="xdireccionfiscal" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xdireccionfiscal').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xdireccionfiscal').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xdireccionfiscal').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Datos del vehiculo -->
            <div class="card">
             <div class="card-header company-card-header"><h5 class="card-title">Datos del Vehículo</h5></div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required" for="form3Examplev3">Placa</label>
                      <input type="text" formControlName="xplaca" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xplaca').errors }" (change)="OperatioValidationPlate()" />
                      <div *ngIf="submitted && inclusion_form.get('xplaca').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xplaca').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                </div>
                  <div class="col-sm-12 col-md-4">
                    <div class="form-outline">
                        <label class="form-label" for="form3Examplev5">Marca</label>
                        <div >
                        <ng-autocomplete  [data]="brandList" [searchKeyword]="keyword" 
                                        placeholder="Seleccionar Marca" (selected)='getModeloData($event)'
                                        [itemTemplate]="itemTemplate" [notFoundTemplate]="notFoundTemplate">                                 
                        </ng-autocomplete>
                    
                        <ng-template #itemTemplate let-item >
                            <a [innerHTML]="item.value"></a>
                        </ng-template>
                    
                        <ng-template #notFoundTemplate let-notFound  >
                            <div [innerHTML]="notFound"></div>
                        </ng-template>
                      </div>
                    </div>
                  </div> 

                  <div class="col-sm-12 col-md-4">
                    <div class="form-outline">
                        <label class="form-label" for="form3Examplev5">Modelo</label>
                        
                        <ng-autocomplete  [data]="modelList" [searchKeyword]="keyword" 
                                        placeholder="Seleccionar Modelo" (selected)='getVersionData($event)'
                                        [itemTemplate]="itemTemplate" [notFoundTemplate]="notFoundTemplate">                                 
                        </ng-autocomplete>
                    
                        <ng-template #itemTemplate let-item >
                            <a [innerHTML]="item.value"></a>
                        </ng-template>
                    
                        <ng-template #notFoundTemplate let-notFound >
                            <div [innerHTML]="notFound"></div>
                        </ng-template>
                      
                    </div>
                  </div> 

                  <div class="col-sm-12 col-md-4">
                    <div class="form-outline">
                        <label class="form-label" for="form3Examplev5">Version</label>
                        
                        <ng-autocomplete  [data]="versionList" [searchKeyword]="keyword" 
                                        placeholder="Seleccionar Version" (selected)='searchVersion($event)'
                                        [itemTemplate]="itemTemplate" [notFoundTemplate]="notFoundTemplate">                                 
                        </ng-autocomplete>
                    
                        <ng-template #itemTemplate let-item >
                            <a [innerHTML]="item.value"></a>
                        </ng-template>
                    
                        <ng-template #notFoundTemplate let-notFound >
                            <div [innerHTML]="notFound"></div>
                        </ng-template>
                      
                    </div>
                  </div> 
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required">Año del automovi</label>
                      <input type="number" formControlName="cano" class="form-control form-control-lg"  [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('cano').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('cano').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('cano').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required">Número de Pasajeros</label>
                      <input type="text" formControlName="ncapacidad_p" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('ncapacidad_p').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('ncapacidad_p').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('ncapacidad_p').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required" for="form3Examplev3">Color</label>
                      <select formControlName="xcolor" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xcolor').errors } ">
                        <option></option>
                        <option *ngFor="let color of colorList" value="{{ color.value }}">{{ color.value }}</option>
                      </select>
                      <div *ngIf="submitted && inclusion_form.get('xcolor').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xcolor').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline">
                      <label class="form-label required" for="form3Examplev2">Serial de Carroceria</label>
                      <input type="text" formControlName="xserialcarroceria" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xserialcarroceria').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xserialcarroceria').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xserialcarroceria').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline ">
                      <label class="form-label required" for="form3Examplea8">Serial de Motor</label>
                      <input type="text" formControlName="xserialmotor" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xserialmotor').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xserialmotor').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xserialmotor').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline ">
                      <label class="form-label required" for="form3Examplea8">Suma Asegurada</label>
                      <input type="text" formControlName="msuma_a_casco" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('msuma_a_casco').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('msuma_a_casco').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('msuma_a_casco').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline ">
                      <label class="form-label required" for="form3Examplea8">Deducible</label>
                      <input type="text" formControlName="mdeducible" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('mdeducible').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('mdeducible').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('mdeducible').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline ">
                      <label class="form-label required" for="form3Examplea8">Póliza</label>
                      <input type="text" formControlName="xpoliza" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xpoliza').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xpoliza').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xpoliza').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4 pb-2">
                    <div class="form-outline ">
                      <label class="form-label required" for="form3Examplea8">Certificado</label>
                      <input type="text" formControlName="xcertificado" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xcertificado').errors }" />
                      <div *ngIf="submitted && inclusion_form.get('xcertificado').errors" class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xcertificado').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3 mb-4 pb-2">
                    <div class="form-outline">                        
                      <label class="form-label required" for="form3Examplev4">Tipo de Vehículo</label>
                      <select formControlName="xtipo" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xtipo').errors } ">
                        <option></option>
                        <option *ngFor="let vehicle of vehicleTypeList" value="{{ vehicle.value }}">{{ vehicle.value }}</option>
                      </select>                      
                      <div *ngIf="submitted && inclusion_form.get('xtipo').errors"  class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xtipo').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3 mb-4 pb-2">
                    <div class="form-outline">                        
                      <label class="form-label required" for="form3Examplev4">Clase</label>
                      <select formControlName="xclase" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('xclase').errors } ">
                        <option></option>
                        <option *ngFor="let clase of classList" value="{{ clase.value }}">{{ clase.value }}</option>
                      </select>                                             
                      <div *ngIf="submitted && inclusion_form.get('xclase').errors"  class="invalid-feedback">
                        <div *ngIf="inclusion_form.get('xclase').errors.required">Se requiere completar el campo</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!--Detalles del plan -->
            <div class="cards">
             <div class="card-header company-card-header">
               <h5 class="card-title">Detalles del plan</h5>
             </div>
              <div class="row" style="padding: 10px;">
                <div class="col-md-4 mb-4 pb-2">
                  <div class="form-outline">
                    <label class="form-label required" for="form3Examplev4">Planes</label>
                    <select formControlName="cplan" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('cplan').errors }" (change)="searchService()">
                      <option></option>
                      <option *ngFor="let plan of planList" value="{{ plan.control }}">{{ plan.value }}</option>
                    </select>
                    <div *ngIf="submitted && inclusion_form.get('cplan').errors" class="invalid-feedback">
                      <div *ngIf="inclusion_form.get('cplan').errors.required">Se requiere completar el campo</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Detalles del recibo -->
            <div class="cards">
              <div class="card-header company-card-header"><h5 class="card-title">Detalles del recibo</h5></div>
              <div class="row" style="padding: 10px;">
                <div class="col-md-2 mb-4 pb-2 mb-md-0 pb-md-0">
                  <div class="form-outline">
                    <label for="form3Examplev5">Fecha de Inicio del Contrato</label>
                    <input type="date" formControlName="fdesde_pol" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('fdesde_pol').errors }" />
                    <div *ngIf="submitted && inclusion_form.get('fdesde_pol').errors" class="invalid-feedback">
                    </div>
                  </div>
                </div>
                <div class="col-md-2 mb-4 pb-2 mb-md-0 pb-md-0">
                  <div class="form-outline">
                    <label for="form3Examplev5">Fecha Final del Contrato</label>
                    <input type="date" formControlName="fhasta_pol" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('fhasta_pol').errors }" />
                    <div *ngIf="submitted && inclusion_form.get('fhasta_pol').errors" class="invalid-feedback">
                    </div>
                  </div>
                </div>
                <div class="col-md-2 mb-4 pb-2 mb-md-0 pb-md-0">
                  <div class="form-outline">
                    <label class="form-label required" for="form3Examplev5">Fecha de Inclusión al Contrato</label>
                    <input type="date" formControlName="femision" class="form-control form-control-lg" [ngClass]="{ 'is-invalid' : submitted && inclusion_form.get('femision').errors }" />
                    <div *ngIf="submitted && inclusion_form.get('femision').errors" class="invalid-feedback">
                      <div *ngIf="inclusion_form.get('femision').errors.required">Se requiere completar el campo</div>
                    </div>
                  </div>
                </div>
                <br>
                <div class="button">
                  <button [disabled]="loading" type="button" class="btn btn-light btn-lg" data-mdb-ripple-color="dark" (click)="onSubmit(inclusion_form.value)">
                    <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
                    Emitir Servicio
                  </button>
                  <!-- <button type="button" class="btn btn-light btn-lg" style="background-color: red;" (click)="onClearForm()">Limpiar Formulario</button> -->
                </div> 
              </div> 
            </div>

            
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

 <app-footer></app-footer>
